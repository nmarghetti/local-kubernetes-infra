# Automatically generated by ./scripts/flux_setup_tenants.sh
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
resources:
  - rbac.yaml
  - role.yaml
patches:
  # You need to give access to the tenant for each of its namespace
  - target:
      kind: RoleBinding
      name: team-foo-reconciler
      namespace: foo-infra
    patch: |-
      - op: add
        path: /subjects/-
        value:
          kind: ServiceAccount
          name: team-foo
          namespace: foo
  - patch: |-
      apiVersion: v1
      kind: Namespace
      metadata:
        name: foo-infra
        labels:
          project: foo
  - target:
      kind: RoleBinding
      name: team-foo-reconciler
      namespace: foo-app
    patch: |-
      - op: add
        path: /subjects/-
        value:
          kind: ServiceAccount
          name: team-foo
          namespace: foo
  - patch: |-
      apiVersion: v1
      kind: Namespace
      metadata:
        name: foo-app
        labels:
          project: foo
  - target:
      kind: RoleBinding
      name: team-foo-reconciler
      namespace: foo-minikube
    patch: |-
      - op: add
        path: /subjects/-
        value:
          kind: ServiceAccount
          name: team-foo
          namespace: foo
  - patch: |-
      apiVersion: v1
      kind: Namespace
      metadata:
        name: foo-minikube
        labels:
          project: foo
